# 用基于BERT的UniLM模型生成对子
基于BERT模型的对子生成器，使用[simplebert](https://github.com/gaolichen/simplebert)框架编写。[UniLM](https://arxiv.org/abs/1905.03197)模型是一种利用BERT做seq2seq生成的方法。

## 主要功能

- 给出上联，对出下联

## 例子

以下每行取自测试数据，由tab键隔开，第一部分是上联，第二部分是测试数据的下联，第三部分是程序生成的下联：

```
牛从东岳骑来,仁圣天齐尊大帝	虎在南娄坐定,武威神勇掌丰都	虎自北江腾起,神农尝草救苍生
寒山生寂碧	树密鸟声幽	冷月落残红
佳水佳山佳客	新年新景新人	新风新貌新居
白发悲花落	青丝盼春来	红颜恨水流
扫花莫叹春风远	把酒休愁雨夜长	种柳常忧野草寒
春回大地,喜迎山河披锦绣	华夏腾飞,彰显江淮新篇章	喜至人间,欢庆岁月展辉煌
一米阳光同灿烂	半间草屋共欢欣	满园桃李竞芬芳
愚公未惜移山力	壮士须怀断腕观	老子犹存入世心
天下商机商天下	古今诚信诚古今	人间圣迹圣人间
思亲泪落吴江冷	望月魂归蜀道难	望月愁生楚水愁
```

再看一个，著名的回文的对子：上海自来水来自海上。程序给出了两个答案，我觉得还不错：
```
南海归心人心归海南
南湖照水山水照湖南
```

## 运行方法
- 安装simplebert： `pip install simplerbert`
- 在本目录的上一层目录下，运行`python -m couplet.train`

## 讨论
我只对模型训练了一个epoch就得到以上的结果，所以生成对子的质量还有提升的空间。粗看了一下测试数据的结果，模型至少有以下不足之处：
- 不能理解有文化内涵的对子：比如上联`朱温称帝梁朝伟`，模型生成结果`白帝封侯汉世芳`，明显历史事件和人物对不上。
- 无法处理含谐音关系的对子：比如上联`松下问童子,桐子收成几许`，模型生成`月明照故人,故人不过千年`，明显没有理解`童子`和`桐子`音同字不同的关系。

个人感觉以上两个问题，似乎很难用目前的Transformer模型解决，希望以后可以改进。
